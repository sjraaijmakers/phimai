---
import { galleryImages } from '../data/images';

// Transform the gallery images to the format expected by the component
const galleryImagesFormatted = galleryImages.map(img => ({
  src: `/images/${img.filename}`,
  alt: img.alt,
  description: img.description
}));
---

<section id="gallery" class="gallery">
  <div class="container">
    <div class="section-header">
      <h2>Our Tiny Homes</h2>
      <p>Enjoy small town living when you stay in our cozy tiny homes. We offer the tranquility of open spaces without sacrificing comfort. Walk or bike to local dining, markets, and attractions—the ancient Phimai Historical Park and the iconic Sai Ngam mangrove—all just minutes away.</p>
    </div>

    <div class="photo-gallery">
      <div class="gallery-grid">
        {galleryImagesFormatted.slice(0, 4).map((image, index) => (
          <div class="gallery-item main-item" style={`--delay: ${index * 0.1}s`} data-index={index}>
            <img src={image.src} alt={image.alt} loading="lazy" />
            {image.description && image.description.trim() !== '' && (
              <div class="image-overlay">
                <p>{image.description}</p>
              </div>
            )}
          </div>
        ))}
      </div>
      
      <div class="gallery-thumbnails">
        {galleryImagesFormatted.slice(4, 10).map((image, index) => (
          <div class="gallery-thumb" style={`--delay: ${(index + 4) * 0.1}s`} data-index={index + 4}>
            <img src={image.src} alt={image.alt} loading="lazy" />
            {image.description && image.description.trim() !== '' && (
              <div class="thumb-overlay">
                <p>{image.description}</p>
              </div>
            )}
          </div>
        ))}
        
        {galleryImagesFormatted.length > 10 && (
          <div class="show-more-overlay" id="showMoreBtn">
            <div class="show-more-content">
              <span class="show-more-text">+{galleryImagesFormatted.length - 10} more</span>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6,9 12,15 18,9"></polyline>
              </svg>
            </div>
          </div>
        )}
      </div>
      
      {galleryImagesFormatted.length > 10 && (
        <div class="hidden-gallery" id="hiddenGallery">
          <div class="gallery-thumbnails">
            {galleryImagesFormatted.slice(10).map((image, index) => (
              <div class="gallery-thumb" style={`--delay: ${(index + 10) * 0.1}s`} data-index={index + 10}>
                <img src={image.src} alt={image.alt} loading="lazy" />
                {image.description && image.description.trim() !== '' && (
                  <div class="thumb-overlay">
                    <p>{image.description}</p>
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      )}
    </div>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="lightbox">
      <div class="lightbox-content">
        <button class="lightbox-close">&times;</button>
        <button class="lightbox-prev">&#8249;</button>
        <button class="lightbox-next">&#8250;</button>
        <img id="lightbox-image" src="" alt="" />
        <div class="lightbox-description">
          <p id="lightbox-text"></p>
        </div>
      </div>
    </div>

         <div class="property-details">
       <div class="details-content">
         <div class="location-section">
           <h3>Discover Phimai</h3>
           <p>Immerse yourself in the rich history and natural beauty of Phimai. Our tiny homes are perfectly positioned to explore the ancient Khmer temple complex, the iconic Sai Ngam banyan tree forest, and the charming local markets. Experience authentic Thai culture in this peaceful small town setting.</p>
           <a href="https://maps.google.com/?q=Phimai+Historical+Park+Thailand" target="_blank" rel="noopener" class="btn btn-outline">
             <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
               <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
               <circle cx="12" cy="10" r="3"></circle>
             </svg>
             Open in Google Maps
           </a>
         </div>
         
         <div class="map-section">
           <div class="map-container">
             <div class="map-embed">
               <iframe 
                 src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3825.8234567890123!2d102.4956789!3d15.2234567!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2sPhimai%20Historical%20Park!5e0!3m2!1sen!2sth!4v1234567890123!5m2!1sen!2sth"
                 width="100%" 
                 height="100%" 
                 style="border:0; border-radius: 8px;" 
                 allowfullscreen="" 
                 loading="lazy" 
                 referrerpolicy="no-referrer-when-downgrade">
               </iframe>
             </div>
           </div>
         </div>
       </div>
     </div>
  </div>
</section>

<script>
  // Show more gallery functionality
  document.addEventListener('DOMContentLoaded', () => {
    const showMoreBtn = document.getElementById('showMoreBtn');
    const hiddenGallery = document.getElementById('hiddenGallery');
    
    if (showMoreBtn && hiddenGallery) {
      showMoreBtn.addEventListener('click', () => {
        hiddenGallery.classList.add('show');
        showMoreBtn.style.display = 'none';
      });
    }
  });
</script>

<style>
  .gallery {
    padding: 5rem 2rem;
    background: #FEFEFE;
  }



  .section-header {
    text-align: center;
    margin-bottom: 4rem;
  }

  .section-header h2 {
    font-family: 'Crimson Text', serif;
    font-size: 2.5rem;
    font-weight: 600;
    color: #3A3A3A;
    margin-bottom: 1.5rem;
    letter-spacing: -0.02em;
  }

  .section-header p {
    font-size: 1.15rem;
    color: #6B6B6B;
    line-height: 1.7;
    max-width: 800px;
    margin: 0 auto;
    font-family: 'Inter', sans-serif;
    font-weight: 300;
  }

  .photo-gallery {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin-bottom: 4rem;
  }

  .gallery-grid {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    gap: 1rem;
    height: 400px;
  }

  .gallery-item.main-item:first-child {
    grid-row: 1 / 3;
  }

  .gallery-thumbnails {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 1rem;
    position: relative;
  }

  .gallery-thumb {
    aspect-ratio: 1;
    overflow: hidden;
    border-radius: var(--border-radius-sm);
    opacity: 0;
    transform: translateY(10px);
    animation: fadeInUp 0.4s ease-out forwards;
    animation-delay: var(--delay);
  }

  .gallery-thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: contrast(1.05) saturate(0.85);
    transition: transform 0.3s ease, filter 0.3s ease;
  }

  .gallery-thumb:hover img {
    transform: scale(1.05);
    filter: contrast(1.1) saturate(0.9);
  }

  .view-all-overlay {
    position: absolute;
    top: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: rgba(44, 44, 44, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .view-all-overlay:hover {
    background: rgba(44, 44, 44, 0.9);
  }

  .gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: var(--border-radius);
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.6s ease-out forwards;
    animation-delay: var(--delay);
    cursor: pointer;
  }

  .gallery-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: contrast(1.05) saturate(0.85);
    transition: transform 0.3s ease, filter 0.3s ease;
  }

  .gallery-item:hover img {
    transform: scale(1.02);
    filter: contrast(1.1) saturate(0.9);
  }

  .image-overlay,
  .thumb-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
    color: white;
    padding: 2rem 1rem 1rem;
    transform: translateY(100%);
    transition: transform 0.3s ease;
  }

  .thumb-overlay {
    padding: 1rem 0.5rem 0.5rem;
    font-size: 0.8rem;
  }

  .gallery-item:hover .image-overlay,
  .gallery-thumb:hover .thumb-overlay {
    transform: translateY(0);
  }

  .image-overlay p,
  .thumb-overlay p {
    margin: 0;
    font-size: 0.9rem;
    line-height: 1.4;
  }

  .gallery-thumb {
    cursor: pointer;
  }

  .show-more-overlay {
    position: absolute;
    top: 0;
    right: 0;
    width: 100%;
    height: 100%;
    background: rgba(44, 44, 44, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.3s ease;
    border-radius: var(--border-radius-sm);
  }

  .show-more-overlay:hover {
    background: rgba(44, 44, 44, 0.9);
  }

  .show-more-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
  }

  .show-more-text {
    font-size: 0.9rem;
    font-weight: 600;
  }

  .show-more-overlay svg {
    transition: transform 0.3s ease;
  }

  .show-more-overlay:hover svg {
    transform: translateY(2px);
  }

  .hidden-gallery {
    display: none;
    margin-top: 1rem;
  }

  .hidden-gallery.show {
    display: block;
  }

  .property-details {
    margin-top: 4rem;
    padding-top: 4rem;
    border-top: 1px solid #F0F0F0;
  }

  .details-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    width: 100%;
  }

  .location-section h3 {
    font-family: 'Crimson Text', serif;
    font-size: 1.6rem;
    font-weight: 600;
    color: #3A3A3A;
    margin-bottom: 1.5rem;
  }

  .location-section {
    width: 100%;
  }

  .location-section p {
    color: #6B6B6B;
    line-height: 1.7;
    margin-bottom: 2rem;
    font-family: 'Inter', sans-serif;
    font-weight: 300;
  }

  .map-section {
    width: 100%;
    height: 100%;
  }

  .map-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .map-embed {
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: 0 8px 30px rgba(139, 115, 85, 0.15);
    height: 100%;
    min-height: 300px;
  }

  .map-embed iframe {
    height: 100%;
    min-height: 300px;
  }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Lightbox Styles */
  .lightbox {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(5px);
  }

  .lightbox.active {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .lightbox-content {
    position: relative;
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #lightbox-image {
    max-width: 100%;
    max-height: 80vh;
    object-fit: contain;
    border-radius: 8px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  }

  .lightbox-description {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    padding: 1rem 2rem;
    border-radius: 0 0 8px 8px;
    max-width: 100%;
    text-align: center;
  }

  .lightbox-description p {
    margin: 0;
    color: #2C2C2C;
    font-size: 1rem;
  }

  .lightbox-close,
  .lightbox-prev,
  .lightbox-next {
    position: absolute;
    background: rgba(255, 255, 255, 0.9);
    border: none;
    color: #2C2C2C;
    font-size: 2rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
  }

  .lightbox-close {
    top: 20px;
    right: 20px;
  }

  .lightbox-prev {
    left: 20px;
    top: 50%;
    transform: translateY(-50%);
  }

  .lightbox-next {
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
  }

  .lightbox-close:hover,
  .lightbox-prev:hover,
  .lightbox-next:hover {
    background: white;
    transform: scale(1.1);
  }

  .lightbox-prev:hover {
    transform: translateY(-50%) scale(1.1);
  }

  .lightbox-next:hover {
    transform: translateY(-50%) scale(1.1);
  }

  @media (max-width: 768px) {
    .gallery {
      padding: 3rem 1rem;
    }

    .section-header h2 {
      font-size: 2rem;
    }

    .gallery-grid {
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 200px 200px;
      height: auto;
    }

    .gallery-thumbnails {
      grid-template-columns: repeat(3, 1fr);
    }

         .details-content {
       grid-template-columns: 1fr;
       gap: 2rem;
     }

     .map-container {
       margin-top: 1rem;
     }

     .map-embed {
       min-height: 250px;
     }

     .map-embed iframe {
       min-height: 250px;
     }

    .lightbox-close,
    .lightbox-prev,
    .lightbox-next {
      width: 40px;
      height: 40px;
      font-size: 1.5rem;
    }

    .lightbox-close {
      top: 10px;
      right: 10px;
    }

    .lightbox-prev {
      left: 10px;
    }

    .lightbox-next {
      right: 10px;
    }
  }
</style>