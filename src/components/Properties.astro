---
import { siteConfig } from '../config/site';
import { galleryImages } from '../data/images';
import Lightbox from './Lightbox.astro';
---

<section id="gallery" class="properties">
  <div class="container">
    <div class="properties-content">
      <div class="properties-header">
            <h2 data-i18n="gallery.title" />
    <p data-i18n="gallery.subtitle" />
      </div>

      <div class="gallery-grid">
        <div class="gallery-item featured" data-index={0}>
          <img src="/images/tiny-home-exterior.jpg" alt="Tiny home exterior" loading="lazy">
        </div>
        <div class="gallery-item" data-index={1}>
          <img src="/images/interior-living.jpg" alt="Tiny home interior living space" loading="lazy">
        </div>
        <div class="gallery-item" data-index={2}>
          <img src="/images/bedroom.jpg" alt="Comfortable bedroom space" loading="lazy">
        </div>
        <div class="gallery-item" data-index={3}>
          <img src="/images/kitchenette.jpg" alt="Kitchenette with essentials" loading="lazy">
        </div>
        <div class="gallery-item" data-index={4}>
          <img src="/images/family-suite.jpg" alt="Family suite accommodation" loading="lazy">
        </div>
      </div>

      <div class="location-section">
        <div class="location-info">
          <h3 data-i18n="gallery.location.title" />
          <p data-i18n="gallery.location.description" />
          
          <div class="location-features">
            <div class="location-feature">
              <div class="feature-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
              </div>
              <span data-i18n="gallery.location.historicalPark" />
            </div>
            <div class="location-feature">
              <div class="feature-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
              </div>
              <span data-i18n="gallery.location.mangrove" />
            </div>
            <div class="location-feature">
              <div class="feature-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
              </div>
              <span data-i18n="gallery.location.localMarkets" />
            </div>
          </div>
        </div>

        <div class="location-map">
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3825.1234567890123!2d102.494444!3d15.223333!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMTXCsDEzJzI0LjAiTiAxMDLCsDI5JzQwLjAiRQ!5e0!3m2!1sen!2sth!4v1234567890123"
            width="100%" 
            height="300" 
            style="border:0;" 
            allowfullscreen="" 
            loading="lazy" 
            referrerpolicy="no-referrer-when-downgrade"
            title="Phimai Pond House Location"
            class="map-iframe">
          </iframe>
        </div>
      </div>
    </div>
  </div>
</section>

<Lightbox />

<script>
  // Gallery lightbox functionality
  document.addEventListener('DOMContentLoaded', () => {
    const galleryImages = [
      {
        src: "/images/tiny-home-exterior.jpg",
        alt: "Tiny home exterior",
        description: "Our charming tiny home exterior with modern design"
      },
      {
        src: "/images/interior-living.jpg",
        alt: "Tiny home interior living space",
        description: "Comfortable living area with all essentials"
      },
      {
        src: "/images/bedroom.jpg",
        alt: "Comfortable bedroom space",
        description: "Cozy bedroom with quality linens"
      },
      {
        src: "/images/kitchenette.jpg",
        alt: "Kitchenette with essentials",
        description: "Fully equipped kitchenette for your convenience"
      },
      {
        src: "/images/family-suite.jpg",
        alt: "Family suite accommodation",
        description: "Spacious family accommodation for larger groups"
      }
    ];

    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightbox-image');
    const lightboxText = document.getElementById('lightbox-text');
    const closeBtn = document.querySelector('.lightbox-close');
    const prevBtn = document.querySelector('.lightbox-prev');
    const nextBtn = document.querySelector('.lightbox-next');
    
    let currentImageIndex = 0;

    function openLightbox(index: number) {
      currentImageIndex = index;
      const image = galleryImages[index];
      if (lightboxImage && lightboxText && lightbox) {
        (lightboxImage as HTMLImageElement).src = image.src;
        (lightboxImage as HTMLImageElement).alt = image.alt;
        lightboxText.textContent = image.description || '';
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
      }
    }

    function closeLightbox() {
      if (lightbox) {
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
      }
    }

    function showPrevImage() {
      currentImageIndex = (currentImageIndex - 1 + galleryImages.length) % galleryImages.length;
      openLightbox(currentImageIndex);
    }

    function showNextImage() {
      currentImageIndex = (currentImageIndex + 1) % galleryImages.length;
      openLightbox(currentImageIndex);
    }

    // Add click listeners to gallery items
    document.querySelectorAll('.gallery-item').forEach(item => {
      item.addEventListener('click', () => {
        const index = parseInt((item as HTMLElement).dataset.index || '0');
        openLightbox(index);
      });
    });

    // Lightbox controls
    if (closeBtn) closeBtn.addEventListener('click', closeLightbox);
    if (prevBtn) prevBtn.addEventListener('click', showPrevImage);
    if (nextBtn) nextBtn.addEventListener('click', showNextImage);

    // Close lightbox when clicking outside image
    if (lightbox) {
      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
          closeLightbox();
        }
      });
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (!lightbox || !lightbox?.classList.contains('active')) return;
      
      switch(e.key) {
        case 'Escape':
          closeLightbox();
          break;
        case 'ArrowLeft':
          showPrevImage();
          break;
        case 'ArrowRight':
          showNextImage();
          break;
      }
    });
  });
</script>

